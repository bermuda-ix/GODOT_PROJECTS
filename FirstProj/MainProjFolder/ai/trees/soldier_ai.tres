[gd_resource type="BehaviorTree" load_steps=85 format=3 uid="uid://bkpyddqh402xp"]

[ext_resource type="Script" uid="uid://w637xlbev2om" path="res://ai/tasks/find_player.gd" id="1_7px3v"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_2djuw"]
var/attack_mode/name = &"attack_mode"
var/attack_mode/type = 1
var/attack_mode/value = false
var/attack_mode/hint = 0
var/attack_mode/hint_string = ""
var/ranged_mode/name = &"ranged_mode"
var/ranged_mode/type = 1
var/ranged_mode/value = false
var/ranged_mode/hint = 0
var/ranged_mode/hint_string = ""
var/melee_mode/name = &"melee_mode"
var/melee_mode/type = 1
var/melee_mode/value = false
var/melee_mode/hint = 0
var/melee_mode/hint_string = ""
var/within_range/name = &"within_range"
var/within_range/type = 1
var/within_range/value = false
var/within_range/hint = 0
var/within_range/hint_string = ""
var/counter_attack/name = &"counter_attack"
var/counter_attack/type = 1
var/counter_attack/value = false
var/counter_attack/hint = 0
var/counter_attack/hint_string = ""
var/counter_kick_flag/name = &"counter_kick_flag"
var/counter_kick_flag/type = 1
var/counter_kick_flag/value = false
var/counter_kick_flag/hint = 0
var/counter_kick_flag/hint_string = ""
var/shoot_counter/name = &"shoot_counter"
var/shoot_counter/type = 2
var/shoot_counter/value = 0
var/shoot_counter/hint = 0
var/shoot_counter/hint_string = ""
var/staggered/name = &"staggered"
var/staggered/type = 1
var/staggered/value = false
var/staggered/hint = 0
var/staggered/hint_string = ""

[sub_resource type="BBVariant" id="BBVariant_s1wjr"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_or1gh"]
variable = &"attack_mode"
value = SubResource("BBVariant_s1wjr")
custom_name = "AttackMode"

[sub_resource type="BBVariant" id="BBVariant_cj7pg"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTCheckVar" id="BTCheckVar_qpg7m"]
variable = &"staggered"
value = SubResource("BBVariant_cj7pg")

[sub_resource type="BBVariant" id="BBVariant_qkysk"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_cj7pg"]
variable = &"melee_mode"
value = SubResource("BBVariant_qkysk")

[sub_resource type="BBVariant" id="BBVariant_ex4gl"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_gi26e"]
variable = &"within_range"
value = SubResource("BBVariant_ex4gl")

[sub_resource type="BTAction" id="BTAction_2i8b5"]
script = ExtResource("1_7px3v")
group = &"player"
target_var = &"target"

[sub_resource type="BTCheckTrigger" id="BTCheckTrigger_vjri2"]
variable = &"counter_attack"

[sub_resource type="BTCheckTrigger" id="BTCheckTrigger_wr2jt"]
variable = &"counter_kick_flag"

[sub_resource type="BBNode" id="BBNode_vjri2"]
saved_value = NodePath("MeleeAttackManager")
resource_name = "MeleeAttackManager"

[sub_resource type="BTCallMethod" id="BTCallMethod_wr2jt"]
node = SubResource("BBNode_vjri2")
method = &"melee_counter"

[sub_resource type="BBNode" id="BBNode_cj7pg"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTAwaitAnimation" id="BTAwaitAnimation_qpg7m"]
animation_player = SubResource("BBNode_cj7pg")
animation_name = &"atk_counter"
max_time = 5.0

[sub_resource type="BTSequence" id="BTSequence_wr2jt"]
custom_name = "CounterKick"
children = [SubResource("BTCheckTrigger_wr2jt"), SubResource("BTCallMethod_wr2jt"), SubResource("BTAwaitAnimation_qpg7m")]

[sub_resource type="BBVariant" id="BBVariant_qpg7m"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BBNode" id="BBNode_kadvv"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_j4731"]
node = SubResource("BBNode_kadvv")
method = &"rapid_shoot"
args = Array[BBVariant]([SubResource("BBVariant_qpg7m")])

[sub_resource type="BBNode" id="BBNode_wr2jt"]
saved_value = NodePath("DodgeManager")
resource_name = "DodgeManager"

[sub_resource type="BTCallMethod" id="BTCallMethod_qkysk"]
node = SubResource("BBNode_wr2jt")
method = &"dodge"

[sub_resource type="BBNode" id="BBNode_qkysk"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTAwaitAnimation" id="BTAwaitAnimation_cj7pg"]
animation_player = SubResource("BBNode_qkysk")
animation_name = &"dodge"
max_time = 0.2

[sub_resource type="BBVariant" id="BBVariant_vjri2"]
type = 3
saved_value = 0.05
resource_name = "0.05000000000291"

[sub_resource type="BBNode" id="BBNode_xienf"]
saved_value = NodePath("ShootAttackManager")
resource_name = "ShootAttackManager"

[sub_resource type="BTCallMethod" id="BTCallMethod_0uopn"]
node = SubResource("BBNode_xienf")
method = &"shoot_setup"
args = Array[BBVariant]([SubResource("BBVariant_vjri2")])

[sub_resource type="BBNode" id="BBNode_qpg7m"]
saved_value = NodePath("ShootAttackManager")
resource_name = "ShootAttackManager"

[sub_resource type="BTCallMethod" id="BTCallMethod_xienf"]
node = SubResource("BBNode_qpg7m")
method = &"shoot"

[sub_resource type="BTWait" id="BTWait_vjri2"]
duration = 0.1

[sub_resource type="BTSequence" id="BTSequence_cj7pg"]
children = [SubResource("BTCallMethod_xienf"), SubResource("BTWait_vjri2")]

[sub_resource type="BTRepeat" id="BTRepeat_cj7pg"]
times = 3
children = [SubResource("BTSequence_cj7pg")]

[sub_resource type="BBVariant" id="BBVariant_wr2jt"]
type = 3
saved_value = 0.2
resource_name = "0.19999999999709"

[sub_resource type="BBNode" id="BBNode_0uopn"]
saved_value = NodePath("ShootAttackManager")
resource_name = "ShootAttackManager"

[sub_resource type="BTCallMethod" id="BTCallMethod_5tega"]
node = SubResource("BBNode_0uopn")
method = &"shoot_setup"
args = Array[BBVariant]([SubResource("BBVariant_wr2jt")])

[sub_resource type="BBVariant" id="BBVariant_xienf"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BBNode" id="BBNode_j4731"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_myvia"]
node = SubResource("BBNode_j4731")
method = &"rapid_shoot"
args = Array[BBVariant]([SubResource("BBVariant_xienf")])

[sub_resource type="BTConsolePrint" id="BTConsolePrint_vjri2"]
text = "reloading"

[sub_resource type="BTWait" id="BTWait_wr2jt"]
duration = 0.4

[sub_resource type="BTConsolePrint" id="BTConsolePrint_wr2jt"]
text = "reloading done"

[sub_resource type="BTSequence" id="BTSequence_qpg7m"]
custom_name = "CounterShoot"
children = [SubResource("BTCallMethod_j4731"), SubResource("BTCallMethod_qkysk"), SubResource("BTAwaitAnimation_cj7pg"), SubResource("BTCallMethod_0uopn"), SubResource("BTRepeat_cj7pg"), SubResource("BTCallMethod_5tega"), SubResource("BTCallMethod_myvia"), SubResource("BTConsolePrint_vjri2"), SubResource("BTWait_wr2jt"), SubResource("BTConsolePrint_wr2jt")]

[sub_resource type="BTSelector" id="BTSelector_vjri2"]
custom_name = "CounterTypes"
children = [SubResource("BTSequence_wr2jt"), SubResource("BTSequence_qpg7m")]

[sub_resource type="BBNode" id="BBNode_5tega"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_kadvv"]
node = SubResource("BBNode_5tega")
method = &"counter_select"

[sub_resource type="BTSequence" id="BTSequence_qkysk"]
custom_name = "CounterAttack"
children = [SubResource("BTCheckTrigger_vjri2"), SubResource("BTSelector_vjri2"), SubResource("BTCallMethod_kadvv")]

[sub_resource type="BBVariant" id="BBVariant_eahdn"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_aa25s"]
variable = &"melee_mode"
value = SubResource("BBVariant_eahdn")

[sub_resource type="BBNode" id="BBNode_ysbiq"]
saved_value = NodePath("MeleeAttackManager")
resource_name = "MeleeAttackManager"

[sub_resource type="BTCallMethod" id="BTCallMethod_qwr6t"]
node = SubResource("BBNode_ysbiq")
method = &"melee_attack"

[sub_resource type="BTSequence" id="BTSequence_yfw6d"]
custom_name = "Attack"
children = [SubResource("BTCheckVar_aa25s"), SubResource("BTCallMethod_qwr6t")]

[sub_resource type="BTCooldown" id="BTCooldown_5mvyu"]
duration = 0.8
start_cooled = true
children = [SubResource("BTSequence_yfw6d")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_vjri2"]

[sub_resource type="BTSelector" id="BTSelector_qpg7m"]
custom_name = "attacks"
children = [SubResource("BTSequence_qkysk"), SubResource("BTCooldown_5mvyu"), SubResource("BTAlwaysSucceed_vjri2")]

[sub_resource type="BTSequence" id="BTSequence_7vhxb"]
custom_name = "AttackRange"
children = [SubResource("BTCheckVar_gi26e"), SubResource("BTAction_2i8b5"), SubResource("BTSelector_qpg7m")]

[sub_resource type="BTAction" id="BTAction_kugyc"]
script = ExtResource("1_7px3v")
group = &"player"
target_var = &"target"

[sub_resource type="BBNode" id="BBNode_hd7qm"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_ok4as"]
node = SubResource("BBNode_hd7qm")
method = &"chase"

[sub_resource type="BTSequence" id="BTSequence_5qq8g"]
custom_name = "Get In Range"
children = [SubResource("BTAction_kugyc"), SubResource("BTCallMethod_ok4as")]

[sub_resource type="BTSelector" id="BTSelector_3ojif"]
custom_name = "Getting in range"
children = [SubResource("BTSequence_7vhxb"), SubResource("BTSequence_5qq8g")]

[sub_resource type="BTSequence" id="BTSequence_c1urr"]
custom_name = "Melee"
children = [SubResource("BTCheckVar_cj7pg"), SubResource("BTSelector_3ojif")]

[sub_resource type="BBVariant" id="BBVariant_0uopn"]
type = 2
saved_value = 0
resource_name = "<null>"

[sub_resource type="BTCheckVar" id="BTCheckVar_5tega"]
variable = &"ammo"
check_type = 2
value = SubResource("BBVariant_0uopn")

[sub_resource type="BTConsolePrint" id="BTConsolePrint_kadvv"]

[sub_resource type="BBNode" id="BBNode_myvia"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_k3jx5"]
animation_player = SubResource("BBNode_myvia")
animation_name = &"reload"

[sub_resource type="BBNode" id="BBNode_x777n"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTAwaitAnimation" id="BTAwaitAnimation_p7kfe"]
animation_player = SubResource("BBNode_x777n")
animation_name = &"reload"

[sub_resource type="BTSequence" id="BTSequence_pb4ri"]
custom_name = "Reload"
children = [SubResource("BTCheckVar_5tega"), SubResource("BTConsolePrint_kadvv"), SubResource("BTPlayAnimation_k3jx5"), SubResource("BTAwaitAnimation_p7kfe")]

[sub_resource type="BBVariant" id="BBVariant_cle5d"]
type = 2
saved_value = 0
resource_name = "<null>"

[sub_resource type="BTCheckVar" id="BTCheckVar_nmhtu"]
variable = &"ammo"
check_type = 3
value = SubResource("BBVariant_cle5d")

[sub_resource type="BTConsolePrint" id="BTConsolePrint_tv5vl"]

[sub_resource type="BBNode" id="BBNode_uo0gr"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_1tbiw"]
animation_player = SubResource("BBNode_uo0gr")
animation_name = &"shoot"

[sub_resource type="BBNode" id="BBNode_77dq3"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTAwaitAnimation" id="BTAwaitAnimation_pnek3"]
animation_player = SubResource("BBNode_77dq3")
animation_name = &"shoot"

[sub_resource type="BTSequence" id="BTSequence_4yj4i"]
custom_name = "Shoot"
children = [SubResource("BTCheckVar_nmhtu"), SubResource("BTConsolePrint_tv5vl"), SubResource("BTPlayAnimation_1tbiw"), SubResource("BTAwaitAnimation_pnek3")]

[sub_resource type="BTSelector" id="BTSelector_sfx0f"]
custom_name = "ShootingStance"
children = [SubResource("BTSequence_pb4ri"), SubResource("BTSequence_4yj4i")]

[sub_resource type="BTSelector" id="BTSelector_ct688"]
children = [SubResource("BTSequence_c1urr"), SubResource("BTSelector_sfx0f")]

[sub_resource type="BTSequence" id="BTSequence_vjri2"]
children = [SubResource("BTCheckVar_qpg7m"), SubResource("BTSelector_ct688")]

[sub_resource type="BTRepeatUntilFailure" id="BTRepeatUntilFailure_vwcxk"]
children = [SubResource("BTSequence_vjri2")]

[sub_resource type="BTSequence" id="BTSequence_df28b"]
custom_name = "Attacks"
children = [SubResource("BTCheckVar_or1gh"), SubResource("BTRepeatUntilFailure_vwcxk")]

[sub_resource type="BTSelector" id="BTSelector_307xj"]
children = [SubResource("BTSequence_df28b")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_2djuw")
root_task = SubResource("BTSelector_307xj")
