[gd_resource type="BehaviorTree" load_steps=52 format=3 uid="uid://cynrrfs5iidbs"]

[ext_resource type="Script" uid="uid://w637xlbev2om" path="res://ai/tasks/find_player.gd" id="1_dk6q0"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_fopnx"]
var/ammo/name = &"ammo"
var/ammo/type = 2
var/ammo/value = 0
var/ammo/hint = 0
var/ammo/hint_string = ""

[sub_resource type="BBVariant" id="BBVariant_2nsp0"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_7tj05"]
variable = &"attack_mode"
value = SubResource("BBVariant_2nsp0")
custom_name = "AttackMode"

[sub_resource type="BBVariant" id="BBVariant_dy0rb"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTCheckVar" id="BTCheckVar_pquhl"]
variable = &"staggered"
value = SubResource("BBVariant_dy0rb")

[sub_resource type="BBVariant" id="BBVariant_dk6q0"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_fopnx"]
variable = &"melee_mode"
value = SubResource("BBVariant_dk6q0")

[sub_resource type="BBVariant" id="BBVariant_fh6a1"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_bob2m"]
variable = &"within_range"
value = SubResource("BBVariant_fh6a1")

[sub_resource type="BTAction" id="BTAction_exfju"]
script = ExtResource("1_dk6q0")
group = &"player"
target_var = &"target"

[sub_resource type="BBVariant" id="BBVariant_i45wg"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_wkd5u"]
variable = &"melee_mode"
value = SubResource("BBVariant_i45wg")

[sub_resource type="BBNode" id="BBNode_8sobk"]
saved_value = NodePath("MeleeAttackManager")
resource_name = "MeleeAttackManager"

[sub_resource type="BTCallMethod" id="BTCallMethod_ru3pv"]
node = SubResource("BBNode_8sobk")
method = &"melee_attack"

[sub_resource type="BTSequence" id="BTSequence_virdo"]
custom_name = "Attack"
children = [SubResource("BTCheckVar_wkd5u"), SubResource("BTCallMethod_ru3pv")]

[sub_resource type="BTCooldown" id="BTCooldown_gb5fh"]
duration = 0.8
start_cooled = true
children = [SubResource("BTSequence_virdo")]

[sub_resource type="BTSelector" id="BTSelector_heplg"]
custom_name = "attacks"
children = [SubResource("BTCooldown_gb5fh")]

[sub_resource type="BTSequence" id="BTSequence_mqn1v"]
custom_name = "AttackRange"
children = [SubResource("BTCheckVar_bob2m"), SubResource("BTAction_exfju"), SubResource("BTSelector_heplg")]

[sub_resource type="BTAction" id="BTAction_2k4od"]
script = ExtResource("1_dk6q0")
group = &"player"
target_var = &"target"

[sub_resource type="BBNode" id="BBNode_uiybs"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_eurjc"]
node = SubResource("BBNode_uiybs")
method = &"chase"

[sub_resource type="BTSequence" id="BTSequence_0qxda"]
custom_name = "Get In Range"
children = [SubResource("BTAction_2k4od"), SubResource("BTCallMethod_eurjc")]

[sub_resource type="BTSelector" id="BTSelector_whd42"]
custom_name = "Getting in range"
children = [SubResource("BTSequence_mqn1v"), SubResource("BTSequence_0qxda")]

[sub_resource type="BTSequence" id="BTSequence_ojhjv"]
custom_name = "Melee"
children = [SubResource("BTCheckVar_fopnx"), SubResource("BTSelector_whd42")]

[sub_resource type="BBVariant" id="BBVariant_7tj05"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_dy0rb"]
variable = &"ranged_mode"
value = SubResource("BBVariant_7tj05")

[sub_resource type="BBVariant" id="BBVariant_fopnx"]
type = 2
saved_value = 0
resource_name = "<null>"

[sub_resource type="BTCheckVar" id="BTCheckVar_2nsp0"]
variable = &"ammo"
check_type = 2
value = SubResource("BBVariant_fopnx")

[sub_resource type="BTConsolePrint" id="BTConsolePrint_7tj05"]

[sub_resource type="BBNode" id="BBNode_dy0rb"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_pquhl"]
animation_player = SubResource("BBNode_dy0rb")
animation_name = &"reload"

[sub_resource type="BBNode" id="BBNode_fh6a1"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTAwaitAnimation" id="BTAwaitAnimation_bob2m"]
animation_player = SubResource("BBNode_fh6a1")
animation_name = &"reload"

[sub_resource type="BTSequence" id="BTSequence_exfju"]
children = [SubResource("BTCheckVar_2nsp0"), SubResource("BTConsolePrint_7tj05"), SubResource("BTPlayAnimation_pquhl"), SubResource("BTAwaitAnimation_bob2m")]

[sub_resource type="BBVariant" id="BBVariant_wkd5u"]
type = 2
saved_value = 0
resource_name = "<null>"

[sub_resource type="BTCheckVar" id="BTCheckVar_8sobk"]
variable = &"ammo"
check_type = 3
value = SubResource("BBVariant_wkd5u")

[sub_resource type="BTConsolePrint" id="BTConsolePrint_ru3pv"]

[sub_resource type="BBNode" id="BBNode_virdo"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_gb5fh"]
animation_player = SubResource("BBNode_virdo")
animation_name = &"shoot"

[sub_resource type="BBNode" id="BBNode_fcnui"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTAwaitAnimation" id="BTAwaitAnimation_heplg"]
animation_player = SubResource("BBNode_fcnui")
animation_name = &"shoot"

[sub_resource type="BTSequence" id="BTSequence_2k4od"]
children = [SubResource("BTCheckVar_8sobk"), SubResource("BTConsolePrint_ru3pv"), SubResource("BTPlayAnimation_gb5fh"), SubResource("BTAwaitAnimation_heplg")]

[sub_resource type="BTSelector" id="BTSelector_uiybs"]
children = [SubResource("BTSequence_exfju"), SubResource("BTSequence_2k4od")]

[sub_resource type="BTSequence" id="BTSequence_bob2m"]
custom_name = "Shoot"
children = [SubResource("BTCheckVar_dy0rb"), SubResource("BTSelector_uiybs")]

[sub_resource type="BTCooldown" id="BTCooldown_hp7h8"]
duration = 0.5
start_cooled = true
children = [SubResource("BTSequence_bob2m")]

[sub_resource type="BTSelector" id="BTSelector_ahbr2"]
children = [SubResource("BTSequence_ojhjv"), SubResource("BTCooldown_hp7h8")]

[sub_resource type="BTSequence" id="BTSequence_381y2"]
children = [SubResource("BTCheckVar_pquhl"), SubResource("BTSelector_ahbr2")]

[sub_resource type="BTRepeatUntilFailure" id="BTRepeatUntilFailure_fiv6f"]
children = [SubResource("BTSequence_381y2")]

[sub_resource type="BTSequence" id="BTSequence_hoto7"]
custom_name = "Attacks"
children = [SubResource("BTCheckVar_7tj05"), SubResource("BTRepeatUntilFailure_fiv6f")]

[sub_resource type="BTSelector" id="BTSelector_pr0i6"]
children = [SubResource("BTSequence_hoto7")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_fopnx")
root_task = SubResource("BTSelector_pr0i6")
