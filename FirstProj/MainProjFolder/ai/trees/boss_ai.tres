[gd_resource type="BehaviorTree" load_steps=48 format=3 uid="uid://c73vwom3cvpxj"]

[ext_resource type="Script" path="res://ai/tasks/find_player.gd" id="1_7h010"]
[ext_resource type="Script" path="res://ai/tasks/chase_player.gd" id="2_4ykdd"]
[ext_resource type="Script" path="res://ai/tasks/within_range.gd" id="3_nv67j"]
[ext_resource type="Script" path="res://ai/tasks/keep_range.gd" id="4_sosob"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_ewtji"]
var/stunned/name = &"stunned"
var/stunned/type = 1
var/stunned/value = false
var/stunned/hint = 0
var/stunned/hint_string = ""
var/flee/name = &"flee"
var/flee/type = 1
var/flee/value = false
var/flee/hint = 0
var/flee/hint_string = ""
var/full_combo/name = &"full_combo"
var/full_combo/type = 1
var/full_combo/value = false
var/full_combo/hint = 0
var/full_combo/hint_string = ""
var/light_attack/name = &"light_attack"
var/light_attack/type = 1
var/light_attack/value = false
var/light_attack/hint = 0
var/light_attack/hint_string = ""
var/phase/name = &"phase"
var/phase/type = 2
var/phase/value = 0
var/phase/hint = 0
var/phase/hint_string = ""

[sub_resource type="BTCheckTrigger" id="BTCheckTrigger_b28o3"]
variable = &"stunned"

[sub_resource type="BTWait" id="BTWait_me2xo"]
duration = 3.0

[sub_resource type="BBVariant" id="BBVariant_kj0oc"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTSetVar" id="BTSetVar_gxaq8"]
variable = &"light_attack"
value = SubResource("BBVariant_kj0oc")

[sub_resource type="BBVariant" id="BBVariant_p2t7x"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTSetVar" id="BTSetVar_pewli"]
variable = &"flee"
value = SubResource("BBVariant_p2t7x")

[sub_resource type="BBVariant" id="BBVariant_2mqon"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTSetVar" id="BTSetVar_4gtqa"]
variable = &"full_combo"
value = SubResource("BBVariant_2mqon")

[sub_resource type="BTSequence" id="BTSequence_meyx0"]
custom_name = "Stunned"
children = [SubResource("BTCheckTrigger_b28o3"), SubResource("BTWait_me2xo"), SubResource("BTSetVar_gxaq8"), SubResource("BTSetVar_pewli"), SubResource("BTSetVar_4gtqa")]

[sub_resource type="BBVariant" id="BBVariant_rm4n4"]
type = 2
saved_value = 0
resource_name = "0"

[sub_resource type="BTCheckVar" id="BTCheckVar_yhs3h"]
variable = &"phase"
value = SubResource("BBVariant_rm4n4")

[sub_resource type="BTAction" id="BTAction_tycts"]
script = ExtResource("1_7h010")
group = &"player"
target_var = &"target"

[sub_resource type="BTAction" id="BTAction_k5yrd"]
script = ExtResource("3_nv67j")
target_var = &"target"
range = 40

[sub_resource type="BBNode" id="BBNode_bnn7y"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_fthev"]
node = SubResource("BBNode_bnn7y")
method = &"attack_combo"

[sub_resource type="BTSequence" id="BTSequence_1q3mw"]
custom_name = "Full Combo"
children = [SubResource("BTAction_tycts"), SubResource("BTAction_k5yrd"), SubResource("BTCallMethod_fthev")]

[sub_resource type="BTAction" id="BTAction_d246x"]
script = ExtResource("1_7h010")
group = &"player"
target_var = &"target"

[sub_resource type="BTAction" id="BTAction_aatcr"]
script = ExtResource("2_4ykdd")
target_var = &"target"
speed_var = 60
tolerance = 40

[sub_resource type="BTSequence" id="BTSequence_gwxtd"]
custom_name = "Chase Player"
children = [SubResource("BTAction_d246x"), SubResource("BTAction_aatcr")]

[sub_resource type="BTSelector" id="BTSelector_qwgg4"]
children = [SubResource("BTSequence_1q3mw"), SubResource("BTSequence_gwxtd")]

[sub_resource type="BTSequence" id="BTSequence_apnts"]
children = [SubResource("BTCheckVar_yhs3h"), SubResource("BTSelector_qwgg4")]

[sub_resource type="BBVariant" id="BBVariant_di7pp"]
type = 2
saved_value = 1
resource_name = "1"

[sub_resource type="BTCheckVar" id="BTCheckVar_jmiw3"]
variable = &"phase"
value = SubResource("BBVariant_di7pp")

[sub_resource type="BTAction" id="BTAction_p4nv7"]
script = ExtResource("1_7h010")
group = &"player"
target_var = &"target"

[sub_resource type="BTAction" id="BTAction_eq0q8"]
script = ExtResource("4_sosob")
target_var = &"target"
speed_var = 60
tolerance = 120
max_range = 150

[sub_resource type="BBVariant" id="BBVariant_qg4kb"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTSetVar" id="BTSetVar_p2jry"]
variable = &"flee"
value = SubResource("BBVariant_qg4kb")

[sub_resource type="BBVariant" id="BBVariant_boef1"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTSetVar" id="BTSetVar_jfp08"]
variable = &"light_attack"
value = SubResource("BBVariant_boef1")

[sub_resource type="BTSequence" id="BTSequence_ma0ac"]
custom_name = "Flee"
children = [SubResource("BTAction_p4nv7"), SubResource("BTAction_eq0q8"), SubResource("BTSetVar_p2jry"), SubResource("BTSetVar_jfp08")]

[sub_resource type="BTProbability" id="BTProbability_b65ni"]
run_chance = 1.0
children = [SubResource("BTSequence_ma0ac")]

[sub_resource type="BTAction" id="BTAction_61o0w"]
script = ExtResource("1_7h010")
group = &"player"
target_var = &"target"

[sub_resource type="BTAction" id="BTAction_ltxrg"]
script = ExtResource("3_nv67j")
target_var = &"target"
range = 40

[sub_resource type="BBNode" id="BBNode_75mhd"]
saved_value = NodePath(".")
resource_name = "."

[sub_resource type="BTCallMethod" id="BTCallMethod_fu5t4"]
node = SubResource("BBNode_75mhd")
method = &"light_attack"

[sub_resource type="BBVariant" id="BBVariant_y2tff"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTSetVar" id="BTSetVar_j3kwk"]
variable = &"light_attack"
value = SubResource("BBVariant_y2tff")

[sub_resource type="BTSequence" id="BTSequence_4kra6"]
custom_name = "Attack Player"
children = [SubResource("BTAction_61o0w"), SubResource("BTAction_ltxrg"), SubResource("BTCallMethod_fu5t4"), SubResource("BTSetVar_j3kwk")]

[sub_resource type="BTProbability" id="BTProbability_amx5k"]
children = [SubResource("BTSequence_4kra6")]

[sub_resource type="BTSelector" id="BTSelector_bj2yc"]
children = [SubResource("BTProbability_b65ni"), SubResource("BTProbability_amx5k")]

[sub_resource type="BTSequence" id="BTSequence_f8es7"]
children = [SubResource("BTCheckVar_jmiw3"), SubResource("BTSelector_bj2yc")]

[sub_resource type="BTSelector" id="BTSelector_ne57j"]
children = [SubResource("BTSequence_meyx0"), SubResource("BTSequence_apnts"), SubResource("BTSequence_f8es7")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_ewtji")
root_task = SubResource("BTSelector_ne57j")
